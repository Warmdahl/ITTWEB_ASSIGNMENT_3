(this.webpackJsonpweb_assignment3_v2=this.webpackJsonpweb_assignment3_v2||[]).push([[0],{35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var s=n(2),o=n(0),i=n.n(o),a=n(25),r=n.n(a),c=(n(35),n(5)),h=n(11),l=n(9),u=n(7),d=n(6),p=(n(36),n(46)),j=n(47),g=n(48),b=n(49),v=n.p+"static/media/logo.103b5fa1.svg",m=(n(37),n(19)),f=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={position:[Number,Number],sound:Number},s}return n}(o.Component);f.position=[Number,Number],f.sound=Number;var O=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e,s,o){var i;return Object(c.a)(this,n),(i=t.call(this,o)).state={history:[],score:0,timerToken:0,rows:e,columns:s,onFlash:f},i.onScoreChange=i.onScoreChange.bind.this,i}return Object(h.a)(n,[{key:"onScoreChange",value:function(e,t){}},{key:"start",value:function(e){var t=this;this.state.onFlash=e,this.state.timerToken=setInterval((function(){e(t.next())}),2500)}},{key:"stop",value:function(){clearInterval(this.state.timerToken),delete this.state.onFlash}},{key:"samePosition",value:function(){this.state.history.length>1&&m.isEqual(this.state.history[this.state.history.length-1].position,this.state.history[this.state.history.length-2].position)?this.updateScore(100):this.updateScore(-50)}},{key:"sameSound",value:function(){this.state.history.length>1&&m.isEqual(this.state.history[this.state.history.length-1].sound,this.state.history[this.state.history.length-2].sound)?this.updateScore(100):this.updateScore(-50)}},{key:"next",value:function(){var e={};if(this.state.history.length>0&&this.randomInRagne(1,100)<=15)e.position=this.state.history[this.state.history.length-1].position;else{var t=this.randomInRagne(0,this.state.rows-1),n=this.randomInRagne(0,this.state.columns-1);e.position=[t,n]}if(this.state.history.length>0&&this.randomInRagne(1,100)<=15)e.sound=this.state.history[this.state.history.length-1].sound;else{var s=this.randomInRagne(1,9);e.sound=s}return this.state.history.push(e),e}},{key:"updateScore",value:function(e){var t=this.state.score+e;this.onScoreChange&&this.onScoreChange(this.state.score,t),this.state.score=t}},{key:"randomInRagne",value:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},{key:"setrowcol",value:function(e,t){this.state.rows=e,this.state.columns=t}}]),n}(i.a.Component),y=(n(39),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={columns:s.props.columns,rows:s.props.rows,highlight:s.props.highlight},s}return Object(h.a)(n,[{key:"render",value:function(){for(var e=[],t=0;t<this.props.rows;++t){for(var n=[],o=0;o<this.props.columns;++o){var i=["square","square-100"];this.props.highlight&&this.props.highlight[0]===t&&this.props.highlight[1]===o&&i.push("one"),n.push(Object(s.jsx)("div",{className:"grid-cell grid-"+Math.floor(100/this.props.columns),children:Object(s.jsx)("div",{className:i.join(" "),children:t*this.props.columns+o+1})},o+1))}e.push(Object(s.jsx)("div",{className:"grid",children:n},t+1))}return Object(s.jsx)("div",{className:"grid-container",children:e})}}]),n}(o.Component)),w=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={rows:s.props.rows,columns:s.props.columns,board:new O(s.props.rows,s.props.columns),onScoreChange:(s.props.prevScore,s.props.nextScore),currentFlash:f,running:s.props.running},s.tryPosition=s.tryPosition.bind(Object(l.a)(s)),s.trySound=s.trySound.bind(Object(l.a)(s)),s.onFlash=s.onFlash.bind(Object(l.a)(s)),s.speak=s.speak.bind(Object(l.a)(s)),s}return Object(h.a)(n,[{key:"componentWillUnmount",value:function(){this.state.board.stop()}},{key:"componentDidUpdate",value:function(e,t,n){!e.running&&this.props.running&&(this.state.board.setrowcol(this.props.rows,this.props.columns),this.state.board.start(this.onFlash),this.state.board.onScoreChange=this.props.onScoreChange),e.running&&!this.props.running&&this.state.board.stop()}},{key:"render",value:function(){var e=[],t=this.props.rows,n=this.props.columns;return this.state.currentFlash&&(e=this.state.currentFlash.position),Object(s.jsxs)("div",{children:[Object(s.jsx)(y,{rows:t,columns:n,highlight:e}),Object(s.jsx)(b.a,{color:"secondary",disabled:!this.props.running,onClick:this.tryPosition,children:"Position Match"}),Object(s.jsx)(b.a,{color:"secondary",disabled:!this.props.running,onClick:this.trySound,children:"Sound Match"})]})}},{key:"tryPosition",value:function(){this.state.board.samePosition()}},{key:"trySound",value:function(){this.state.board.sameSound()}},{key:"onFlash",value:function(e){this.setState(this.state.currentFlash=e),this.speak(e.sound.toString())}},{key:"speak",value:function(e){if("speechSynthesis"in window){var t=new SpeechSynthesisUtterance;t.text=e,t.voice=speechSynthesis.getVoices().filter((function(e){return"Allison"===e.name}))[0],window.speechSynthesis.speak(t)}}}]),n}(o.Component);function S(){var e=localStorage.getItem("jwt");try{if(e){var t=e.split(".")[1],n=window.atob(t);return JSON.parse(n)._id}}catch(s){console.log(s)}}var x=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).ws=new WebSocket("ws://localhost:8080"),s.state={gameRunning:!1,gridSize:3,score:0,dataFromServer:[]},s.setGridSize=s.setGridSize.bind(Object(l.a)(s)),s.onPlay=s.onPlay.bind(Object(l.a)(s)),s.onPause=s.onPause.bind(Object(l.a)(s)),s.onScoreChange=s.onScoreChange.bind(Object(l.a)(s)),s}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.ws.onopen=function(){console.log("connected")},this.ws.onmessage=function(t){var n=JSON.parse(t.data);e.setState(e.state.dataFromServer=n),console.log(n)},this.ws.onclose=function(){console.log("disconnected")}}},{key:"render",value:function(){var e=this.state.gridSize,t=this.state.gridSize,n=this.state.gameRunning,o=this.state.dataFromServer;return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsxs)("header",{className:"App-header",children:[Object(s.jsx)("img",{src:v,className:"App-logo",alt:"logo"}),Object(s.jsx)("h1",{className:"App-title",children:"Welcome to Dual N Back"})]}),Object(s.jsx)(p.a,{children:Object(s.jsxs)(j.a,{children:[Object(s.jsxs)(g.a,{xs:"3",children:[Object(s.jsx)("input",{type:"range",min:"3",max:"5",className:"slider",value:this.state.gridSize,onInput:this.setGridSize,onChange:this.setGridSize}),Object(s.jsx)("p",{children:"Highscore"}),o.map((function(e){return Object(s.jsx)("ol",{children:Object(s.jsx)("p",{children:e.score})})}))]}),Object(s.jsx)(g.a,{xs:"6",children:Object(s.jsx)(w,{rows:e,columns:t,running:n,onScoreChange:this.onScoreChange})}),Object(s.jsxs)(g.a,{xs:"3",children:[Object(s.jsx)(j.a,{children:Object(s.jsxs)(g.a,{xs:"12",children:[Object(s.jsx)(b.a,{color:"primary",className:this.state.gameRunning?"hidden":"",onClick:this.onPlay,children:"Play"}),Object(s.jsx)(b.a,{color:"primary",className:this.state.gameRunning?"":"hidden",onClick:this.onPause,children:"Stop"})]})}),Object(s.jsx)(j.a,{children:Object(s.jsx)("p",{children:this.state.score})})]})]})})]})}},{key:"setGridSize",value:function(e){this.setState({gridSize:e.target.value})}},{key:"onPlay",value:function(e){this.setState({gameRunning:!0})}},{key:"onPause",value:function(e){this.setState({gameRunning:!1});var t={score:this.state.score,date:new Date,userid:S()};this.ws.send(JSON.stringify(t))}},{key:"onScoreChange",value:function(e,t){this.setState({score:t})}}]),n}(o.Component),k=n(16),C=n(4);function N(){return null!=localStorage.getItem("jwt")}var P=n(20),F=n.n(P),L=n(26),I=n(27),R=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={user:[],Loading:!0,username:null,password:null,Error:!1,token:null},s.handleLogin=s.handleLogin.bind(Object(l.a)(s)),s.handleChange=s.handleChange.bind(Object(l.a)(s)),s}return Object(h.a)(n,[{key:"handleChange",value:function(e){var t=e.target.name,n=e.target.value;this.setState(Object(I.a)({},t,n))}},{key:"handleLogin",value:function(){var e=Object(L.a)(F.a.mark((function e(t){var n,s,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={username:this.state.username,password:this.state.password},s=JSON.stringify(n),o=this,fetch("http://localhost:8080/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:s}).then((function(e){e.ok?e.json().then((function(e){console.log("jwt: "+e),localStorage.setItem("jwt",e),window.location.reload(!1)})):(alert("Error in username or password, HTTP error: "+e.status),o.setState({Error:!0}))})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(s.jsx)("div",{children:N()?Object(s.jsx)("h1",{children:"You are logged in"}):Object(s.jsxs)("form",{onSubmit:e.handleLogin,children:[Object(s.jsxs)("label",{children:["Username:",Object(s.jsx)("input",{type:"text",name:"username",value:e.state.username||"",onChange:e.handleChange})]}),Object(s.jsxs)("label",{children:["Password:",Object(s.jsx)("input",{type:"password",name:"password",value:e.state.password||"",onChange:e.handleChange})]}),Object(s.jsx)("input",{type:"submit",value:"Login"})]})})}}]),n}(o.Component),T=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){localStorage.clear(),window.location.reload(!1)}},{key:"render",value:function(){return Object(s.jsx)("div",{children:Object(s.jsx)("h1",{children:"You are logged out"})})}}]),n}(o.Component),W=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(s.jsx)("div",{children:N()?Object(s.jsxs)("div",{children:[Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{children:Object(s.jsx)(k.b,{to:"/Game",children:"Dual-n-Back"})}),Object(s.jsx)("li",{children:Object(s.jsx)(k.b,{to:"/Logout",children:"Logout"})})]}),Object(s.jsx)(C.a,{path:"/Game",component:x}),Object(s.jsx)(C.a,{path:"/Logout",component:T})]}):Object(s.jsxs)("div",{children:[Object(s.jsx)("h1",{children:"Login here!"}),Object(s.jsx)("ul",{children:Object(s.jsx)("li",{children:Object(s.jsx)(k.b,{to:"/login",children:"Login"})})}),Object(s.jsx)(C.a,{path:"/Login",component:R})]})})}}]),n}(o.Component);W.displayName=W.name;var z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,50)).then((function(t){var n=t.getCLS,s=t.getFID,o=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),s(e),o(e),i(e),a(e)}))};r.a.render(Object(s.jsx)(k.a,{children:Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(W,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var s=n.headers.get("content-type");404===n.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):A(t,e)}))}}(),D()}},[[45,1,2]]]);
//# sourceMappingURL=main.7ab4d466.chunk.js.map